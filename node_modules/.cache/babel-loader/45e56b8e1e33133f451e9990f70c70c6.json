{"ast":null,"code":"var _jsxFileName = \"/home/viettran/Desktop/cnpm-19hc-group04/final-project/front-end/src/components/layout/Main/Main.js\";\nimport React, { Component } from 'react';\nimport { Layout } from 'antd';\nimport './Main.style.scss';\nimport links from '../../../constants/sidebar.constant';\nimport { withRouter, Route } from 'react-router-dom';\nimport { withCookies } from 'react-cookie';\nimport { COOKIE_NAMES } from '../../../constants/cookie-name.constant';\nimport Toolbar from '../Toolbar/Toolbar';\nimport Sidebar from '../Sidebar/Sidebar';\nimport USER_ROLE from '../../../constants/user-role.constant';\nimport * as actions from '../../../redux/actions';\nimport { connect } from 'react-redux';\nconst {\n  Footer,\n  Content\n} = Layout;\n\nclass Main extends Component {\n  constructor(props) {\n    super(props);\n    this.cookies = this.props.cookies;\n    this.checkLoggedInUser();\n  }\n\n  checkLoggedInUser() {\n    const user = this.cookies.get(COOKIE_NAMES.user);\n    const token = this.cookies.get(COOKIE_NAMES.token);\n\n    if (!(user && token)) {\n      this.cookies.remove(COOKIE_NAMES.token);\n      this.cookies.remove(COOKIE_NAMES.user);\n      window.location.href = '/login';\n    } else {\n      this.props.login(user, token);\n    }\n  }\n\n  render() {\n    const user = this.cookies.get(COOKIE_NAMES.user) || this.props.loggedInUser.user;\n    const userCommonPages = links.find(link => link.role === USER_ROLE.USER.role).pages;\n    const userPagesByRole = links.find(link => link.role === user.role).pages.concat(userCommonPages);\n    console.log(userCommonPages);\n\n    const PrivateRoute = ({\n      component: Component,\n      ...rest\n    }) => {\n      return React.createElement(Route, Object.assign({}, rest, {\n        render: props => React.createElement(Component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 49\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47\n        },\n        __self: this\n      }));\n    };\n\n    const renderContents = () => {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, userPagesByRole.map((page, pageIndex) => {\n        return React.createElement(PrivateRoute, {\n          key: pageIndex,\n          exact: true,\n          component: page.component,\n          path: `${page.path}`,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 59\n          },\n          __self: this\n        });\n      }));\n    };\n\n    return React.createElement(\"div\", {\n      className: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, React.createElement(Sidebar, {\n      user: user,\n      userPagesByRole: userPagesByRole,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }), React.createElement(Layout, {\n      style: {\n        marginLeft: 200\n      },\n      className: \"animated fadeIn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(Toolbar, {\n      user: user,\n      avatarMenuItems: userCommonPages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }), React.createElement(Content, {\n      className: \"__content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"__content__inner\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, renderContents())), React.createElement(Footer, {\n      className: \"__footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, \"Mini Mart \\xA92020 All right reserved.\"))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  loggedInUser: state.loggedInUser\n});\n\nexport default connect(mapStateToProps, actions)(withCookies(withRouter(Main)));","map":{"version":3,"sources":["/home/viettran/Desktop/cnpm-19hc-group04/final-project/front-end/src/components/layout/Main/Main.js"],"names":["React","Component","Layout","links","withRouter","Route","withCookies","COOKIE_NAMES","Toolbar","Sidebar","USER_ROLE","actions","connect","Footer","Content","Main","constructor","props","cookies","checkLoggedInUser","user","get","token","remove","window","location","href","login","render","loggedInUser","userCommonPages","find","link","role","USER","pages","userPagesByRole","concat","console","log","PrivateRoute","component","rest","renderContents","map","page","pageIndex","path","marginLeft","mapStateToProps","state"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,MAAT,QAAuB,MAAvB;AACA,OAAO,mBAAP;AACA,OAAOC,KAAP,MAAkB,qCAAlB;AACA,SAASC,UAAT,EAAqBC,KAArB,QAAkC,kBAAlC;AACA,SAASC,WAAT,QAA4B,cAA5B;AACA,SAASC,YAAT,QAA6B,yCAA7B;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,OAAOC,SAAP,MAAsB,uCAAtB;AACA,OAAO,KAAKC,OAAZ,MAAyB,wBAAzB;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,MAAM;AAAEC,EAAAA,MAAF;AAAUC,EAAAA;AAAV,IAAsBZ,MAA5B;;AAEA,MAAMa,IAAN,SAAmBd,SAAnB,CAA6B;AAG3Be,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,OAAL,GAAe,KAAKD,KAAL,CAAWC,OAA1B;AACA,SAAKC,iBAAL;AACD;;AAEDA,EAAAA,iBAAiB,GAAG;AAClB,UAAMC,IAAI,GAAG,KAAKF,OAAL,CAAaG,GAAb,CAAiBd,YAAY,CAACa,IAA9B,CAAb;AACA,UAAME,KAAK,GAAG,KAAKJ,OAAL,CAAaG,GAAb,CAAiBd,YAAY,CAACe,KAA9B,CAAd;;AAEA,QAAI,EAAEF,IAAI,IAAIE,KAAV,CAAJ,EAAsB;AACpB,WAAKJ,OAAL,CAAaK,MAAb,CAAoBhB,YAAY,CAACe,KAAjC;AACA,WAAKJ,OAAL,CAAaK,MAAb,CAAoBhB,YAAY,CAACa,IAAjC;AACAI,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,QAAvB;AACD,KAJD,MAIO;AACL,WAAKT,KAAL,CAAWU,KAAX,CAAiBP,IAAjB,EAAuBE,KAAvB;AACD;AACF;;AAEDM,EAAAA,MAAM,GAAG;AACP,UAAMR,IAAI,GAAG,KAAKF,OAAL,CAAaG,GAAb,CAAiBd,YAAY,CAACa,IAA9B,KAAuC,KAAKH,KAAL,CAAWY,YAAX,CAAwBT,IAA5E;AACA,UAAMU,eAAe,GAAG3B,KAAK,CAAC4B,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcvB,SAAS,CAACwB,IAAV,CAAeD,IAAhD,EAAsDE,KAA9E;AACA,UAAMC,eAAe,GAAGjC,KAAK,CAAC4B,IAAN,CAAWC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcb,IAAI,CAACa,IAAtC,EAA4CE,KAA5C,CAAkDE,MAAlD,CAAyDP,eAAzD,CAAxB;AAEAQ,IAAAA,OAAO,CAACC,GAAR,CAAYT,eAAZ;;AAEA,UAAMU,YAAY,GAAG,CAAC;AAAEC,MAAAA,SAAS,EAAExC,SAAb;AAAwB,SAAGyC;AAA3B,KAAD,KAAuC;AAC1D,aACE,oBAAC,KAAD,oBACMA,IADN;AAEE,QAAA,MAAM,EAAEzB,KAAK,IAAI,oBAAC,SAAD,oBAAeA,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAFnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF;AAMD,KAPD;;AASA,UAAM0B,cAAc,GAAG,MAAM;AAC3B,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGP,eAAe,CAACQ,GAAhB,CAAoB,CAACC,IAAD,EAAOC,SAAP,KAAqB;AACxC,eACE,oBAAC,YAAD;AACE,UAAA,GAAG,EAAEA,SADP;AAEE,UAAA,KAAK,EAAE,IAFT;AAGE,UAAA,SAAS,EAAED,IAAI,CAACJ,SAHlB;AAIE,UAAA,IAAI,EAAG,GAAEI,IAAI,CAACE,IAAK,EAJrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAQD,OATA,CADH,CADF;AAcD,KAfD;;AAiBA,WACE;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAE3B,IAAf;AAAqB,MAAA,eAAe,EAAEgB,eAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAE;AAAEY,QAAAA,UAAU,EAAE;AAAd,OAAf;AAAoC,MAAA,SAAS,EAAC,iBAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAE5B,IAAf;AAAqB,MAAA,eAAe,EAAEU,eAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,WAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGa,cAAc,EADjB,CADF,CAFF,EAOE,oBAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,UAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gDAPF,CAFF,CADF,CADF;AAkBD;;AAzE0B;;AA4E7B,MAAMM,eAAe,GAAIC,KAAD,KAAY;AAClCrB,EAAAA,YAAY,EAAEqB,KAAK,CAACrB;AADc,CAAZ,CAAxB;;AAIA,eAAejB,OAAO,CAACqC,eAAD,EAAkBtC,OAAlB,CAAP,CAAkCL,WAAW,CAACF,UAAU,CAACW,IAAD,CAAX,CAA7C,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport { Layout } from 'antd';\nimport './Main.style.scss';\nimport links from '../../../constants/sidebar.constant';\nimport { withRouter, Route } from 'react-router-dom';\nimport { withCookies } from 'react-cookie';\nimport { COOKIE_NAMES } from '../../../constants/cookie-name.constant';\nimport Toolbar from '../Toolbar/Toolbar';\nimport Sidebar from '../Sidebar/Sidebar';\nimport USER_ROLE from '../../../constants/user-role.constant';\nimport * as actions from '../../../redux/actions';\nimport { connect } from 'react-redux';\n\nconst { Footer, Content } = Layout;\n\nclass Main extends Component {\n  cookies;\n\n  constructor(props) {\n    super(props);\n    this.cookies = this.props.cookies;\n    this.checkLoggedInUser();\n  }\n\n  checkLoggedInUser() {\n    const user = this.cookies.get(COOKIE_NAMES.user);\n    const token = this.cookies.get(COOKIE_NAMES.token);\n\n    if (!(user && token)) {\n      this.cookies.remove(COOKIE_NAMES.token);\n      this.cookies.remove(COOKIE_NAMES.user);\n      window.location.href = '/login';\n    } else {\n      this.props.login(user, token);\n    }\n  }\n\n  render() {\n    const user = this.cookies.get(COOKIE_NAMES.user) || this.props.loggedInUser.user;\n    const userCommonPages = links.find(link => link.role === USER_ROLE.USER.role).pages;\n    const userPagesByRole = links.find(link => link.role === user.role).pages.concat(userCommonPages);\n\n    console.log(userCommonPages);\n\n    const PrivateRoute = ({ component: Component, ...rest }) => {\n      return (\n        <Route\n          {...rest}\n          render={props => <Component {...props} />}\n        />\n      )\n    }\n\n    const renderContents = () => {\n      return (\n        <div>\n          {userPagesByRole.map((page, pageIndex) => {\n            return (\n              <PrivateRoute\n                key={pageIndex}\n                exact={true}\n                component={page.component}\n                path={`${page.path}`}\n              />\n            )\n          })}\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"main\">\n        <Layout>\n          <Sidebar user={user} userPagesByRole={userPagesByRole} />\n          <Layout style={{ marginLeft: 200 }} className=\"animated fadeIn\">\n            <Toolbar user={user} avatarMenuItems={userCommonPages} />\n            <Content className=\"__content\">\n              <div className=\"__content__inner\">\n                {renderContents()}\n              </div>\n            </Content>\n            <Footer className=\"__footer\">\n              Mini Mart &copy;2020 All right reserved.\n            </Footer>\n          </Layout>\n        </Layout>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  loggedInUser: state.loggedInUser\n})\n\nexport default connect(mapStateToProps, actions)(withCookies(withRouter(Main)));"]},"metadata":{},"sourceType":"module"}