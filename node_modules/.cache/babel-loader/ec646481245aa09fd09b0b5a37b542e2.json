{"ast":null,"code":"var _jsxFileName = \"/home/viettran/Desktop/cnpm-19hc-group04/final-project/front-end/src/components/pages/Manager/ImportingRequest/SupplierManagement/SupplierManagement.js\";\nimport React from 'react';\nimport { Row, Col, Input, Empty, Button, Divider, List, message, Modal } from 'antd';\nimport { SearchOutlined, DeleteOutlined, EnvironmentTwoTone, ExclamationCircleOutlined } from '@ant-design/icons';\nimport './SupplierManagement.style.scss';\nimport { connect } from 'react-redux';\nimport { withCookies } from 'react-cookie';\nimport * as actions from '../../../../../redux/actions';\nimport PageBase from '../../../../utilities/PageBase/PageBase';\nimport { API } from '../../../../../constants/api.constant';\nimport { COOKIE_NAMES } from '../../../../../constants/cookie-name.constant';\nimport * as _ from 'lodash';\nimport AddSupplierDialog from './AddSupplierDialog/AddSupplierDialog';\nimport GoogleMap from '../../../../utilities/GoogleMap/GoogleMap';\nimport EditSupplierDialog from './EditSupplierDialog/EditSupplierDialog';\n\nclass SupplierManagement extends PageBase {\n  constructor(props) {\n    super(props);\n    this.state = {\n      suppliersDataSource: [],\n      filteredSuppliers: [],\n      selectedSupplier: {},\n      supplierSearchText: ''\n    };\n  }\n\n  componentDidMount() {\n    this.loadSuppliers();\n  }\n\n  openRemoveSupplierConfirmDialog(supplierID) {\n    const that = this;\n    let {\n      suppliersDataSource\n    } = this.state;\n    const supplier = suppliersDataSource.find(s => s._id === supplierID);\n    Modal.confirm({\n      title: `Bạn muốn xóa nhà cung cấp ${supplier.name}?`,\n      icon: React.createElement(ExclamationCircleOutlined, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37\n        },\n        __self: this\n      }),\n      content: '',\n      okText: 'Đồng ý',\n      okType: 'danger',\n      cancelText: 'Không, cảm ơn',\n\n      async onOk() {\n        that.props.setAppLoading(false);\n        const res = await (await fetch(API.Manager.SupplierManagment.removeSupplier.replace('{supplierID}', supplierID), {\n          method: 'DELETE',\n          headers: {\n            'Content-type': 'application/json; charset=UTF-8',\n            'token': that.props.cookies.get(COOKIE_NAMES.token)\n          },\n          signal: that.abortController.signal\n        })).json();\n        that.props.setAppLoading(false);\n\n        if (res.status !== 200) {\n          message.error(res.errors[0]);\n          return;\n        }\n\n        suppliersDataSource = suppliersDataSource.filter(s => s._id !== supplierID);\n        that.onSupplierSearchInputChange(that.state.supplierSearchText, suppliersDataSource);\n        that.setState({\n          suppliersDataSource\n        });\n        message.success(res.messages[0]);\n      }\n\n    });\n  }\n\n  async loadSuppliers() {\n    this.props.setAppLoading(true);\n    const res = await (await fetch(API.Manager.SupplierManagment.getSuppliers, {\n      method: 'GET',\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8',\n        'token': this.props.cookies.get(COOKIE_NAMES.token)\n      },\n      signal: this.abortController.signal\n    })).json();\n    this.props.setAppLoading(false);\n\n    if (res.status !== 200) {\n      message.error(res.errors[0]);\n      return;\n    }\n\n    const {\n      suppliers\n    } = res.data;\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliers);\n    this.setState({\n      suppliersDataSource: suppliers\n    });\n  }\n\n  onSupplierSearchInputChange(text, suppliersDataSource, defaultSelectedSupplier) {\n    let {\n      filteredSuppliers\n    } = this.state;\n\n    if (!text) {\n      filteredSuppliers = [...suppliersDataSource];\n    } else {\n      filteredSuppliers = suppliersDataSource.filter(s => {\n        const searchKeys = Object.keys(s).filter(k => ['name'].includes(k));\n\n        for (const k of searchKeys) {\n          if (s[k].toLowerCase().includes(text.toLowerCase())) return true;\n        }\n\n        return false;\n      });\n    }\n\n    this.setState({\n      filteredSuppliers,\n      selectedSupplier: defaultSelectedSupplier || (filteredSuppliers.length > 0 ? filteredSuppliers[0] : {}),\n      supplierSearchText: text\n    });\n  }\n\n  handleSelectSupplier(_id) {\n    const selectedSupplier = _.find(this.state.suppliersDataSource, s => s._id === _id);\n\n    this.setState({\n      selectedSupplier\n    });\n  }\n\n  addToSuppliersDataSource(supplier) {\n    let {\n      suppliersDataSource\n    } = this.state;\n    suppliersDataSource.push(supplier);\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliersDataSource);\n    this.setState({\n      suppliersDataSource\n    });\n  }\n\n  updateSuppliersDataSource(supplier) {\n    const {\n      suppliersDataSource\n    } = this.state;\n\n    const index = _.findIndex(suppliersDataSource, s => s._id === supplier._id);\n\n    if (index < 0) return;\n    suppliersDataSource[index] = { ...supplier\n    };\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliersDataSource, { ...supplier\n    });\n    this.setState({\n      suppliersDataSource\n    });\n  }\n\n  render() {\n    const {\n      filteredSuppliers,\n      selectedSupplier\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"importing-request__container__suppliers__header__title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Nh\\xE0 cung c\\u1EA5p s\\u1EA3n ph\\u1EA9m\")), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__toolbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(Row, {\n      style: {\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 21,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Input, {\n      prefix: React.createElement(SearchOutlined, {\n        style: {\n          marginRight: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }),\n      placeholder: \"T\\xECm ki\\u1EBFm theo t\\xEAn, \\u0111\\u1ECBa ch\\u1EC9, \\u0111i\\u1EC7n tho\\u1EA1i...\",\n      onChange: e => this.onSupplierSearchInputChange(e.target.value, this.state.suppliersDataSource),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    })), React.createElement(Col, {\n      span: 3,\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(AddSupplierDialog, {\n      addToSuppliersDataSource: supplier => this.addToSuppliersDataSource(supplier),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, React.createElement(List, {\n      size: \"small\",\n      dataSource: filteredSuppliers,\n      renderItem: s => React.createElement(List.Item, {\n        onClick: () => this.handleSelectSupplier(s._id),\n        className: `importing-request__container__suppliers__list__item animated fadeIn \n                  ${selectedSupplier._id === s._id ? '--selected' : ''}\n                `,\n        key: s._id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, s.name),\n      locale: {\n        emptyText: React.createElement(Empty, {\n          image: Empty.PRESENTED_IMAGE_SIMPLE,\n          description: \"Ch\\u01B0a c\\xF3 d\\u1EEF li\\u1EC7u\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        })\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__details\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__details__header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"importing-request__container__suppliers__details__header__title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Th\\xF4ng tin li\\xEAn h\\u1EC7\"), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__details__header__toolbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(EditSupplierDialog, {\n      supplier: { ...selectedSupplier\n      },\n      updateSuppliersDataSource: supplier => this.updateSuppliersDataSource(supplier),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }), React.createElement(Button, {\n      shape: \"circle\",\n      icon: React.createElement(DeleteOutlined, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }),\n      className: \"importing-request__container__suppliers__details__header__toolbar__btn\",\n      onClick: () => this.openRemoveSupplierConfirmDialog(selectedSupplier._id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }))), React.createElement(Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__details__content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(Row, {\n      style: {\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"importing-request__container__suppliers__details__content__label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Th\\u01B0\\u01A1ng hi\\u1EC7u\")), React.createElement(Col, {\n      span: 18,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, selectedSupplier.name)), React.createElement(Row, {\n      style: {\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"importing-request__container__suppliers__details__content__label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\")), React.createElement(Col, {\n      span: 18,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, selectedSupplier.phone)), React.createElement(Row, {\n      style: {\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(Col, {\n      span: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"importing-request__container__suppliers__details__content__label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"\\u0110\\u1ECBa ch\\u1EC9\")), React.createElement(Col, {\n      span: 18,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      style: {\n        minHeight: 35,\n        maxHeight: 35\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, selectedSupplier.address))), React.createElement(\"div\", {\n      className: \"importing-request__container__suppliers__details__content__map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, React.createElement(GoogleMap, {\n      width: '100%',\n      height: 200,\n      address: selectedSupplier.address,\n      locationIcon: React.createElement(EnvironmentTwoTone, {\n        twoToneColor: \"crimson\",\n        style: {\n          fontSize: 24\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    })))));\n  }\n\n}\n\nexport default connect(null, actions)(withCookies(SupplierManagement));","map":{"version":3,"sources":["/home/viettran/Desktop/cnpm-19hc-group04/final-project/front-end/src/components/pages/Manager/ImportingRequest/SupplierManagement/SupplierManagement.js"],"names":["React","Row","Col","Input","Empty","Button","Divider","List","message","Modal","SearchOutlined","DeleteOutlined","EnvironmentTwoTone","ExclamationCircleOutlined","connect","withCookies","actions","PageBase","API","COOKIE_NAMES","_","AddSupplierDialog","GoogleMap","EditSupplierDialog","SupplierManagement","constructor","props","state","suppliersDataSource","filteredSuppliers","selectedSupplier","supplierSearchText","componentDidMount","loadSuppliers","openRemoveSupplierConfirmDialog","supplierID","that","supplier","find","s","_id","confirm","title","name","icon","content","okText","okType","cancelText","onOk","setAppLoading","res","fetch","Manager","SupplierManagment","removeSupplier","replace","method","headers","cookies","get","token","signal","abortController","json","status","error","errors","filter","onSupplierSearchInputChange","setState","success","messages","getSuppliers","suppliers","data","text","defaultSelectedSupplier","searchKeys","Object","keys","k","includes","toLowerCase","length","handleSelectSupplier","addToSuppliersDataSource","push","updateSuppliersDataSource","index","findIndex","render","width","marginRight","e","target","value","emptyText","PRESENTED_IMAGE_SIMPLE","phone","minHeight","maxHeight","address","fontSize"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Row, Col, Input, Empty, Button, Divider, List, message, Modal } from 'antd';\nimport { SearchOutlined, DeleteOutlined, EnvironmentTwoTone, ExclamationCircleOutlined } from '@ant-design/icons';\nimport './SupplierManagement.style.scss';\nimport { connect } from 'react-redux';\nimport { withCookies } from 'react-cookie';\nimport * as actions from '../../../../../redux/actions';\nimport PageBase from '../../../../utilities/PageBase/PageBase';\nimport { API } from '../../../../../constants/api.constant';\nimport { COOKIE_NAMES } from '../../../../../constants/cookie-name.constant';\nimport * as _ from 'lodash';\nimport AddSupplierDialog from './AddSupplierDialog/AddSupplierDialog';\nimport GoogleMap from '../../../../utilities/GoogleMap/GoogleMap';\nimport EditSupplierDialog from './EditSupplierDialog/EditSupplierDialog';\n\nclass SupplierManagement extends PageBase {\n  constructor(props) {\n    super(props);\n    this.state = {\n      suppliersDataSource: [],\n      filteredSuppliers: [],\n      selectedSupplier: {},\n      supplierSearchText: ''\n    }\n  }\n\n  componentDidMount() {\n    this.loadSuppliers();\n  }\n\n  openRemoveSupplierConfirmDialog(supplierID) {\n    const that = this;\n    let { suppliersDataSource } = this.state;\n    const supplier = suppliersDataSource.find(s => s._id === supplierID);\n    Modal.confirm({\n      title: `Bạn muốn xóa nhà cung cấp ${supplier.name}?`,\n      icon: <ExclamationCircleOutlined />,\n      content: '',\n      okText: 'Đồng ý',\n      okType: 'danger',\n      cancelText: 'Không, cảm ơn',\n      async onOk() {\n        that.props.setAppLoading(false);\n        const res = await (\n          await fetch(\n            API.Manager.SupplierManagment.removeSupplier.replace('{supplierID}', supplierID),\n            {\n              method: 'DELETE',\n              headers: {\n                'Content-type': 'application/json; charset=UTF-8',\n                'token': that.props.cookies.get(COOKIE_NAMES.token)\n              },\n              signal: that.abortController.signal\n            }\n          )\n        ).json();\n\n        that.props.setAppLoading(false);\n        if (res.status !== 200) {\n          message.error(res.errors[0]);\n          return;\n        }\n\n        suppliersDataSource = suppliersDataSource.filter(s => s._id !== supplierID);\n        that.onSupplierSearchInputChange(that.state.supplierSearchText, suppliersDataSource);\n        that.setState({ suppliersDataSource });\n        message.success(res.messages[0]);\n      }\n    });\n  }\n\n  async loadSuppliers() {\n    this.props.setAppLoading(true);\n    const res = await (\n      await fetch(\n        API.Manager.SupplierManagment.getSuppliers,\n        {\n          method: 'GET',\n          headers: {\n            'Content-type': 'application/json; charset=UTF-8',\n            'token': this.props.cookies.get(COOKIE_NAMES.token)\n          },\n          signal: this.abortController.signal\n        }\n      )\n    ).json();\n\n    this.props.setAppLoading(false);\n    if (res.status !== 200) {\n      message.error(res.errors[0]);\n      return;\n    }\n\n    const { suppliers } = res.data;\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliers);\n    this.setState({ suppliersDataSource: suppliers });\n  }\n\n  onSupplierSearchInputChange(text, suppliersDataSource, defaultSelectedSupplier) {\n    let { filteredSuppliers } = this.state;\n    if (!text) {\n      filteredSuppliers = [...suppliersDataSource];\n    } else {\n      filteredSuppliers = suppliersDataSource.filter(s => {\n        const searchKeys = Object.keys(s).filter(k => ['name'].includes(k));\n        for (const k of searchKeys) {\n          if (s[k].toLowerCase().includes(text.toLowerCase()))\n            return true;\n        }\n        return false;\n      })\n    }\n\n    this.setState({\n      filteredSuppliers,\n      selectedSupplier: defaultSelectedSupplier || (filteredSuppliers.length > 0 ? filteredSuppliers[0] : {}),\n      supplierSearchText: text\n    });\n  }\n\n  handleSelectSupplier(_id) {\n    const selectedSupplier = _.find(this.state.suppliersDataSource, s => s._id === _id);\n    this.setState({ selectedSupplier });\n  }\n\n  addToSuppliersDataSource(supplier) {\n    let { suppliersDataSource } = this.state;\n    suppliersDataSource.push(supplier);\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliersDataSource);\n    this.setState({ suppliersDataSource });\n  }\n\n  updateSuppliersDataSource(supplier) {\n    const { suppliersDataSource } = this.state;\n    const index = _.findIndex(suppliersDataSource, s => s._id === supplier._id);\n\n    if (index < 0)\n      return;\n\n    suppliersDataSource[index] = { ...supplier };\n    this.onSupplierSearchInputChange(this.state.supplierSearchText, suppliersDataSource, { ...supplier });\n    this.setState({ suppliersDataSource });\n  }\n\n  render() {\n    const { filteredSuppliers, selectedSupplier } = this.state;\n    return (\n      <div className=\"importing-request__container__suppliers\">\n        <div className=\"importing-request__container__suppliers__header\">\n          <span className=\"importing-request__container__suppliers__header__title\">\n            Nhà cung cấp sản phẩm\n          </span>\n        </div>\n        <div className=\"importing-request__container__suppliers__toolbar\">\n          <Row style={{ width: '100%' }}>\n            <Col span={21}>\n              <Input\n                prefix={<SearchOutlined style={{ marginRight: 5 }} />}\n                placeholder=\"Tìm kiếm theo tên, địa chỉ, điện thoại...\"\n                onChange={e => this.onSupplierSearchInputChange(e.target.value, this.state.suppliersDataSource)}\n              />\n            </Col>\n            <Col span={3} align=\"center\">\n              <AddSupplierDialog\n                addToSuppliersDataSource={supplier => this.addToSuppliersDataSource(supplier)}\n              />\n            </Col>\n          </Row>\n        </div>\n        <div className=\"importing-request__container__suppliers__list\">\n          <List\n            size=\"small\"\n            dataSource={filteredSuppliers}\n            renderItem={s => (\n              <List.Item\n                onClick={() => this.handleSelectSupplier(s._id)}\n                className={`importing-request__container__suppliers__list__item animated fadeIn \n                  ${selectedSupplier._id === s._id ? '--selected' : ''}\n                `}\n                key={s._id}>\n                {s.name}\n              </List.Item>\n            )}\n            locale={{ emptyText: <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"Chưa có dữ liệu\" /> }}\n          />\n        </div>\n        <div className=\"importing-request__container__suppliers__details\">\n          <div className=\"importing-request__container__suppliers__details__header\">\n            <span className=\"importing-request__container__suppliers__details__header__title\">\n              Thông tin liên hệ\n                    </span>\n            <div className=\"importing-request__container__suppliers__details__header__toolbar\">\n              <EditSupplierDialog\n                supplier={{ ...selectedSupplier }}\n                updateSuppliersDataSource={supplier => this.updateSuppliersDataSource(supplier)}\n              />\n\n              <Button\n                shape=\"circle\"\n                icon={<DeleteOutlined />}\n                className=\"importing-request__container__suppliers__details__header__toolbar__btn\"\n                onClick={() => this.openRemoveSupplierConfirmDialog(selectedSupplier._id)}\n              />\n            </div>\n          </div>\n          <Divider />\n          <div className=\"importing-request__container__suppliers__details__content\">\n            <Row style={{ width: '100%' }}>\n              <Col span={6}>\n                <span className=\"importing-request__container__suppliers__details__content__label\">\n                  Thương hiệu\n                        </span>\n              </Col>\n              <Col span={18}>{selectedSupplier.name}</Col>\n            </Row>\n            <Row style={{ width: '100%' }}>\n              <Col span={6}>\n                <span className=\"importing-request__container__suppliers__details__content__label\">\n                  Số điện thoại\n                        </span>\n              </Col>\n              <Col span={18}>{selectedSupplier.phone}</Col>\n            </Row>\n            <Row style={{ width: '100%' }}>\n              <Col span={6}>\n                <span className=\"importing-request__container__suppliers__details__content__label\">\n                  Địa chỉ\n                        </span>\n              </Col>\n              <Col span={18}>\n                <p style={{ minHeight: 35, maxHeight: 35 }}>\n                  {selectedSupplier.address}\n                </p>\n              </Col>\n            </Row>\n\n            <div className=\"importing-request__container__suppliers__details__content__map\">\n              <GoogleMap\n                width={'100%'}\n                height={200}\n                address={selectedSupplier.address}\n                locationIcon={\n                  <EnvironmentTwoTone\n                    twoToneColor=\"crimson\"\n                    style={{ fontSize: 24 }}\n                  />\n                }\n              />\n            </div>\n\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\nexport default connect(null, actions)(withCookies(SupplierManagement));"]},"metadata":{},"sourceType":"module"}